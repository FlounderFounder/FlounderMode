<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>MVP Theater - Floundermode Dictionary</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="../favicon.ico" />
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Roboto+Mono:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/easy-mode.css">
    <link rel="stylesheet" href="../styles/voting-ui.css">
  </head>
  <body>
    <header class="main-header">
      <div class="header-content">
        <h1 class="page-title">Floundermode Dictionary</h1>
        <nav class="header-nav">
          <a href="../" class="nav-button">‚Üê Back to Dictionary</a>
          <button class="nav-button dark-mode-toggle" onclick="toggleDarkMode()">
            üåô Dark
          </button>
        </nav>
      </div>
    </header>

    <main class="main-content">
      <div class="term-page">
        <h1 class="term-title">MVP Theater</h1>
        
        <div class="definitions-container">
          <h2 class="definitions-title">DEFINITIONS</h2>
          <div class="definitions-list">
            
            <div class="definition-item" id="def-1">
              <div class="definition-content">
                <div class="definition-text">When a team pretends to validate a product by building the tiniest thing possible, but it still takes six months.</div>
                <div class="definition-example">"Our MVP was just a Figma prototype but took longer than building the whole app."</div>
              </div>
              <div class="definition-author">by Carter Wynn 2024-01-15</div>
              <div class="definition-votes">
                <button class="vote-btn vote-up" onclick="submitVote('def-1', 'up')" data-def-id="def-1">
                  ‚ñ≤
                </button>
                <div class="vote-count">0</div>
                <button class="vote-btn vote-down" onclick="submitVote('def-1', 'down')" data-def-id="def-1">
                  ‚ñº
                </button>
                <button class="share-btn" onclick="shareDefinition('def-1')" data-def-id="def-1" title="Share this definition">
                  üì§
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <div class="term-related">
          <h2>Related Terms</h2>
          <div class="related-tags">
            <span class="related-tag">Lean</span>
            <span class="related-tag">Pretend Agile</span>
            <span class="related-tag">Stakeholder Pressure</span>
          </div>
        </div>
        
        <div class="term-actions">
          <button onclick="shareMVPTheater()" class="share-button">
            üì§ Share This Term
          </button>
        </div>
        
        <script>
          function shareMVPTheater() {
            const definitions = [
          {
                    "id": "def-1",
                    "definition": "When a team pretends to validate a product by building the tiniest thing possible, but it still takes six months.",
                    "usage": "Our MVP was just a Figma prototype but took longer than building the whole app.",
                    "author": "Carter Wynn",
                    "isPrimary": true,
                    "upvotes": 0,
                    "downvotes": 0,
                    "netScore": 0
          }
];
            shareTerm('MVP Theater', definitions);
          }
          
          // ===== VOTING SYSTEM FOR HTML PAGES =====
          let userVotes = new Map();
          
          // Load user votes from localStorage
          function loadUserVotes() {
            try {
              const savedVotes = localStorage.getItem('flounderVotes');
              if (savedVotes) {
                const votesData = JSON.parse(savedVotes);
                userVotes = new Map(Object.entries(votesData));
              }
            } catch (error) {
              console.warn('Failed to load user votes:', error);
              userVotes = new Map();
            }
          }
          
          // Save user votes to localStorage
          function saveUserVotes() {
            try {
              const votesData = Object.fromEntries(userVotes);
              localStorage.setItem('flounderVotes', JSON.stringify(votesData));
            } catch (error) {
              console.warn('Failed to save user votes:', error);
            }
          }
          
          // Submit a vote for a definition
          window.submitVote = function(definitionId, voteType) {
            console.log('Voting:', definitionId, voteType);
            
            // Check if user already voted on this definition
            const existingVote = userVotes.get(definitionId);
            
            if (existingVote === voteType) {
              // User is trying to vote the same way again - remove the vote
              userVotes.delete(definitionId);
              updateDefinitionVotes(definitionId, voteType, 'remove');
            } else {
              // User is voting (or changing their vote)
              userVotes.set(definitionId, voteType);
              updateDefinitionVotes(definitionId, voteType, existingVote ? 'change' : 'add');
            }
            
            // Save to localStorage
            saveUserVotes();
            
            // Update the UI
            updateVoteButtons(definitionId);
          };
          
          // Update the vote counts for a definition
          function updateDefinitionVotes(definitionId, voteType, action) {
            // For HTML pages, we'll track votes in a simple way
            // In a real app, this would sync with a backend
            console.log('Updating votes:', definitionId, voteType, action);
          }
          
          // Update the vote button UI
          function updateVoteButtons(definitionId) {
            const upButton = document.querySelector(`button[data-def-id="${definitionId}"].vote-up`);
            const downButton = document.querySelector(`button[data-def-id="${definitionId}"].vote-down`);
            const voteCount = document.querySelector(`button[data-def-id="${definitionId}"].vote-up`).parentElement.querySelector('.vote-count');
            
            if (upButton && downButton && voteCount) {
              const userVote = userVotes.get(definitionId);
              
              // Reset all button states
              upButton.classList.remove('voted');
              downButton.classList.remove('voted');
              
              // Apply voted state
              if (userVote === 'up') {
                upButton.classList.add('voted');
              } else if (userVote === 'down') {
                downButton.classList.add('voted');
              }
              
              // Update vote count (simple local count for demo)
              const upVotes = Array.from(userVotes.values()).filter(v => v === 'up').length;
              const downVotes = Array.from(userVotes.values()).filter(v => v === 'down').length;
              const netScore = upVotes - downVotes;
              voteCount.textContent = netScore;
            }
          }
          
          // Share definition function
          window.shareDefinition = function(definitionId) {
            const definitions = [
          {
                    "id": "def-1",
                    "definition": "When a team pretends to validate a product by building the tiniest thing possible, but it still takes six months.",
                    "usage": "Our MVP was just a Figma prototype but took longer than building the whole app.",
                    "author": "Carter Wynn",
                    "isPrimary": true,
                    "upvotes": 0,
                    "downvotes": 0,
                    "netScore": 0
          }
];
            const definition = definitions.find(d => d.id === definitionId);
            if (!definition) return;

            const shareText = `MVP Theater: ${definition.definition}\n\n"${definition.usage}"\n\n‚Äî ${definition.author || 'Anonymous'}\n\nFrom Floundermode Dictionary`;
            
            if (navigator.share) {
              navigator.share({
                title: `MVP Theater - Floundermode Dictionary`,
                text: shareText,
                url: window.location.href
              }).catch(err => console.log('Error sharing:', err));
            } else {
              // Fallback: copy to clipboard
              navigator.clipboard.writeText(shareText).then(() => {
                // Show a brief success message
                const shareBtn = document.querySelector(`[data-def-id="${definitionId}"]`);
                const originalText = shareBtn.innerHTML;
                shareBtn.innerHTML = '‚úì';
                shareBtn.style.background = '#22c55e';
                shareBtn.style.color = 'white';
                
                setTimeout(() => {
                  shareBtn.innerHTML = originalText;
                  shareBtn.style.background = '';
                  shareBtn.style.color = '';
                }, 1000);
              }).catch(err => {
                console.log('Error copying to clipboard:', err);
                alert('Share text copied to clipboard!');
              });
            }
          };

          // Initialize voting on page load
          document.addEventListener('DOMContentLoaded', function() {
            loadUserVotes();
            // Update all vote buttons with current state
            document.querySelectorAll('[data-def-id]').forEach(button => {
              const defId = button.getAttribute('data-def-id');
              updateVoteButtons(defId);
            });
          });
        </script>
      </div>
    </main>

    <!-- JavaScript Files -->
    <script src="../scripts/simple-profanity-filter.js"></script>
    <script src="../scripts/main.js"></script>
    
    <script>
      // Handle deep linking to specific definitions
      function handleDefinitionDeepLink() {
        const hash = window.location.hash;
        if (hash) {
          const definitionId = hash.substring(1); // Remove the #
          const targetElement = document.getElementById(definitionId);
          if (targetElement) {
            // Scroll to the definition
            targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Add a subtle highlight effect
            targetElement.style.transition = 'box-shadow 0.3s ease';
            targetElement.style.boxShadow = '0 0 20px rgba(0, 123, 255, 0.5)';
            
            // Remove highlight after 3 seconds
            setTimeout(() => {
              targetElement.style.boxShadow = '';
            }, 3000);
          }
        }
      }
      
      // Run on page load
      document.addEventListener('DOMContentLoaded', handleDefinitionDeepLink);
      
      // Also run if hash changes (for single-page navigation)
      window.addEventListener('hashchange', handleDefinitionDeepLink);
    </script>
  </body>
</html>
